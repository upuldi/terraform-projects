# Terraform Modular AWS VPC, ASG, and ALB Setup

## Overview
This project provisions a modular AWS infrastructure using Terraform, including:
- VPC with public and private subnets
- Internet Gateway, NAT Gateway, and route tables
- Security groups for public and private EC2 instances
- Launch templates for EC2 configuration
- Auto Scaling Groups (ASGs) for public and private instances
- Application Load Balancer (ALB) for public ASG
- IAM instance profile for SSM Session Manager
- Dynamic scaling policies based on CPU utilization

## Features
- **Modular Design:** All major components (VPC, subnets, security groups, launch templates, ASGs, ALB, instance profile) are implemented as reusable modules.
- **Public/Private Subnets:** Two public and two private subnets are created by default, configurable via variables.
- **Security:** Public EC2 instances are reachable via HTTP/HTTPS; private instances allow SSH only from the VPC CIDR.
- **Auto Scaling:** ASGs scale in/out based on CPU utilization using CloudWatch alarms and policies.
- **SSM Access:** All EC2 instances have an IAM role for SSM Session Manager.
- **ALB Integration:** Public ASG is registered with an ALB and target group; ALB DNS is output for easy access.
- **Tagging:** All resources are tagged for easy identification.

## Usage
1. **Clone the repository and initialize Terraform:**
   ```sh
   terraform init
   terraform plan
   terraform apply
   ```
2. **Configure variables:**
   - Edit `variables.tf` or use a `terraform.tfvars` file to set VPC CIDR, subnet CIDRs, instance type, names, etc.
   - Set `certificate_arn` if using HTTPS (currently ALB is set to HTTP only).
3. **Outputs:**
   - ALB DNS name (`alb_dns_name`) for public access
   - VPC ID, subnet IDs, ASG names, etc.

## Scaling Policies
- ASGs automatically scale out if average CPU > 60% and scale in if < 20%.
- You can adjust thresholds and cooldowns in the ASG modules.

## Multi-Region/Multi-VPC
- To deploy in multiple regions or VPCs, use provider aliases and call modules multiple times with different variables.

## Best Practices
- Use workspaces or separate state files for different environments.
- Keep secrets and sensitive data out of version control.
- Pin provider versions for stability.
- Add notification actions to scaling policies if needed.

## File Structure
```
.
├── main.tf
├── variables.tf
├── outputs.tf
├── modules/
│   ├── vpc/
│   ├── subnets/
│   ├── security_group/
│   ├── launch_template/
│   ├── public_asg/
│   ├── private_asg/
│   ├── alb/
│   └── instance_profile/
└── public-server-userdata.sh
```

## Authors
- Generated by GitHub Copilot
- Customizable for your organization
# Terraform AWS EC2 + ASG + VPC Example

This project creates:
- A VPC
- Two public subnets
- Two private subnets
- An Internet Gateway and public route table
- A security group for EC2
- A Launch Template for EC2
- An Auto Scaling Group (ASG) using the Launch Template

## Usage

1. Initialize Terraform:
   ```sh
   terraform init
   ```
2. Plan the deployment:
   ```sh
   terraform plan
   ```
3. Apply the configuration:
   ```sh
   terraform apply
   ```

## Outputs
- VPC ID
- Public subnet IDs
- Private subnet IDs
- Auto Scaling Group name
